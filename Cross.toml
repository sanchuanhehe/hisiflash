# Cross compilation configuration for local development
# See: https://github.com/cross-rs/cross
#
# For CI/CD, we use cargo-zigbuild instead of cross to avoid GLIBC compatibility issues.
# This file is mainly for local development with Docker.

[build.env]
passthrough = ["RUST_BACKTRACE", "RUST_LOG"]

[target.aarch64-unknown-linux-gnu]
# Use Ubuntu 22.04 based image for newer GLIBC
image = "ghcr.io/cross-rs/aarch64-unknown-linux-gnu:main"
pre-build = [
    "dpkg --add-architecture arm64",
    "apt-get update && apt-get install -y libudev-dev:arm64"
]

[target.armv7-unknown-linux-gnueabihf]
image = "ghcr.io/cross-rs/armv7-unknown-linux-gnueabihf:main"
pre-build = [
    "dpkg --add-architecture armhf",
    "apt-get update && apt-get install -y libudev-dev:armhf"
]

[target.x86_64-unknown-linux-gnu]
pre-build = [
    "apt-get update && apt-get install -y libudev-dev"
]
